Rakefile for self publishing ebook of Kindle made by scanning paper book.

modify parameters by your environment:
  SRC (must): source PDF file name.
  TOP, BOTTOM, LEFT, RIGHT: default margins (pixel) of trimming.
  SIZE: adjust image size by destination format.
  LEVEL (optional): level option of ImageMagic.

for Debian or Ubuntu user, needs packages below:
  poppler-utils poppler-data imagemagick pdftk sam2p

----

       【自炊したPDFから余白を取り除いてKindle向けに最適化するRakefile】

Kindleで自炊化PDFを読もうとすると、紙面の余白のせいで文字がずいぶんと小さくなります。
このRakefileでトリミングすることで、Kindle向けに余白を最小化したPDFファイルを生成し
ましょう。

ImageMagicの機能を使って余白を自動認識し、ギリギリまで追い込みます。ただしノンブル
などの余計なものをあらかじめカットする領域に含めておきたい場合にはTOP/BOTTOM/LEFT/
RIGHTの値をチューニングして下さい。

再作成する画像は6インチ版Kindleの表示エリアに合わせてリサイズされるので、もっとも
美しく読める状態になります。

PDFファイルごとにRakefileをコピーして、以下の値を書き換えて使って下さい:

  SRC (必須): 最適化元のPDFファイル
  TOP, BOTTOM, LEFT, RIGHT: あらかじめカットしておく領域(ピクセル)
  SIZE: Kindleを縦持ち(portrate)にして読むか横持ち(landscape)にして読むか
  LEVEL (optional): ImageMagicのlevelオプション。地の紙に色が付いている場合に

Rakeコマンドに指定できるタスクは以下です:

  rake : 全行程を一気に実施し、SRC.out.pdfというファイルを作成します
  rake pgm : 第一工程である画像の抽出のみ行います
  rake png : 第一工程で抽出したPGMファイルをKindle向けPNGファイルに変換します
  rake metadata : 元PDFからメタデータを抽出します
  rake pdf : PNGファイルとメタデータを使って変換後のPDFを生成します

最終的に、SRC.out.pdfというファイルができます。Kindleに転送してお読み下さい。
ファイル名が書名になります。また、metadata.txtのAuthorを英数字で書き換えると、
Kindle上に著者名が(英語で)表示されます。
